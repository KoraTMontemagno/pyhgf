
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Non-parametric predictive coding using Dirichlet process nodes &#8212; pyhgf 0.0.16 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=c7cdf6fe"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/Example_4_Dirichlet_process';</script>
    <link rel="icon" href="../_static/logo_small.svg"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo_small.svg" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="../_static/logo_small.svg" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">pyhgf</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../learn.html">
                        Learn
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../cite.html">
                        Cite
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../references.html">
                        References
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ilabcode/pyhgf" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://mastodon.social/@nicolegrand" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-mastodon fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/pyhgf/" title="Pypi" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-solid fa-box fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Pypi</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../learn.html">
                        Learn
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../cite.html">
                        Cite
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../references.html">
                        References
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ilabcode/pyhgf" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://mastodon.social/@nicolegrand" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-mastodon fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/pyhgf/" title="Pypi" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-solid fa-box fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Pypi</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Non-parametr...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="non-parametric-predictive-coding-using-dirichlet-process-nodes">
<span id="example-2"></span><h1>Non-parametric predictive coding using Dirichlet process nodes<a class="headerlink" href="#non-parametric-predictive-coding-using-dirichlet-process-nodes" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Tuple</span>

<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">display</span>
<span class="kn">from</span> <span class="nn">jax</span> <span class="kn">import</span> <span class="n">config</span><span class="p">,</span> <span class="n">jit</span>
<span class="kn">from</span> <span class="nn">jax.scipy.stats.norm</span> <span class="kn">import</span> <span class="n">logpdf</span>
<span class="kn">from</span> <span class="nn">matplotlib.animation</span> <span class="kn">import</span> <span class="n">FuncAnimation</span>
<span class="kn">from</span> <span class="nn">pyhgf.math</span> <span class="kn">import</span> <span class="n">gaussian_surprise</span>
<span class="kn">from</span> <span class="nn">pyhgf.model</span> <span class="kn">import</span> <span class="n">HGF</span>
<span class="kn">from</span> <span class="nn">pyhgf.networks</span> <span class="kn">import</span> <span class="n">add_edges</span><span class="p">,</span> <span class="n">concatenate_networks</span>
<span class="kn">from</span> <span class="nn">pyhgf.typing</span> <span class="kn">import</span> <span class="n">Edges</span><span class="p">,</span> <span class="n">InputIndexes</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">multinomial</span><span class="p">,</span> <span class="n">norm</span>

<span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;jax_disable_jit&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>PyHGF is built on a modular framework that allows working with programmatically pure functions, which means that the structure of the network, as well as the update steps connecting the nodes, are parameters of the belief propagation functions. Most applications of predictive coding neural networks are mostly concerned with the update of the attributes of the network during inference. However, one consequence of this parametrisation is that networks can change their structure during the belief propagation, for example as a function of the prediction errors elicited by the observation. This concept is often referred to as a self-organizing neural network (see for example <span id="id1">[<a class="reference internal" href="../references.html#id15" title="Elias Najarro, Shyam Sudhakaran, and Sebastian Risi. Towards self-assembling artificial neural networks through neural developmental programs. 2023. URL: https://arxiv.org/abs/2307.08197, doi:10.48550/ARXIV.2307.08197.">Najarro <em>et al.</em>, 2023</a>]</span>).</p>
<p>Having a network that can change shape as a function of incoming observations can be a powerful tool if we do not want to parametrise too rigidly our model beforehand, but instead want to let its complexity grow infinitely as observations grow infinitely, a property that is central for nonparametric Bayesian modelling <span id="id2">[<a class="reference internal" href="../references.html#id16" title="Samuel J. Gershman and David M. Blei. A tutorial on bayesian nonparametric models. Journal of Mathematical Psychology, 56(1):1–12, February 2012. URL: http://dx.doi.org/10.1016/j.jmp.2011.08.004, doi:10.1016/j.jmp.2011.08.004.">Gershman and Blei, 2012</a>]</span>. In this notebook, we illustrate how this idea can be applied to create a network that can grow and remove branches and approximates the evolution of a <a class="reference external" href="https://en.wikipedia.org/wiki/Dirichlet_process">Dirichlet process</a>.</p>
<section id="example-1-clustering-observations-from-a-gaussian-mixture">
<h2>Example 1: Clustering observations from a Gaussian mixture<a class="headerlink" href="#example-1-clustering-observations-from-a-gaussian-mixture" title="Link to this heading">#</a></h2>
<section id="create-the-dataset">
<h3>Create the dataset<a class="headerlink" href="#create-the-dataset" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>

<span class="c1"># simulate a dataset</span>
<span class="n">n_trials</span> <span class="o">=</span> <span class="mi">100</span>


<span class="k">def</span> <span class="nf">get_value</span><span class="p">():</span>
    <span class="n">cat</span> <span class="o">=</span> <span class="n">multinomial</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">])</span><span class="o">.</span><span class="n">rvs</span><span class="p">()</span>
    <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">cat</span> <span class="o">*</span> <span class="n">vals</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>


<span class="n">input_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_trials</span><span class="p">):</span>
    <span class="n">input_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_value</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">input_data</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">40</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2d17dc56acddcf582c57dd5619ba0668f456b08602574d092969a50d83d52732.png" src="../_images/2d17dc56acddcf582c57dd5619ba0668f456b08602574d092969a50d83d52732.png" />
</div>
</div>
</section>
<section id="create-the-dirichlet-process-node">
<h3>Create the Dirichlet process node<a class="headerlink" href="#create-the-dirichlet-process-node" title="Link to this heading">#</a></h3>
<section id="the-base-branch">
<h4>The base branch<a class="headerlink" href="#the-base-branch" title="Link to this heading">#</a></h4>
<p>The first component required by the Dirichlet process node is the base branch. This network has a role similar to the base distribution in the Dirichlet process and should encode the structure of the branch that is duplicated. Here, we start with a simple one-level continuous HGF with both a volatility and value parent. This network will try to learn the mean precision of a latent variable (see also {ref)<code class="docutils literal notranslate"><span class="pre">Example_2_Input_node_volatility_coupling</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create the Dirichlet node structure</span>
<span class="n">base_network</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">HGF</span><span class="p">(</span><span class="n">model_type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="o">.</span><span class="n">add_nodes</span><span class="p">(</span>
        <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;continuous-input&quot;</span><span class="p">,</span>
        <span class="n">node_parameters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;input_noise&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;expected_precision&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">},</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">add_nodes</span><span class="p">(</span>
        <span class="n">value_children</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">node_parameters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;tonic_volatility&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;precision&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">}</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">add_nodes</span><span class="p">(</span><span class="n">volatility_children</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">set_update_sequence</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initializing a network with custom node structure.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">base_network</span><span class="o">.</span><span class="n">plot_network</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/df8d2784694f45c319ae47a7000b4dc08c13f05d0e5a32a163756f8fe2466b52.svg" src="../_images/df8d2784694f45c319ae47a7000b4dc08c13f05d0e5a32a163756f8fe2466b52.svg" /></div>
</div>
</section>
<section id="the-likelihood-function">
<h4>The likelihood function<a class="headerlink" href="#the-likelihood-function" title="Link to this heading">#</a></h4>
<p>The second component is the likelihood function of the base network. This function will be used by every branch of the Dirichlet node to compare the likelihood of every new observation. This function should point to the input node(s) of the given branch. Here, the likelihood is simply the Gaussian likelihood given the mean and precision of the underlying distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">log_likelihood_fn</span><span class="p">(</span><span class="n">input_idx</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">attributes</span><span class="p">,</span> <span class="n">edges</span><span class="p">):</span>
    <span class="n">value_parent_idx</span> <span class="o">=</span> <span class="n">edges</span><span class="p">[</span><span class="n">input_idx</span><span class="p">]</span><span class="o">.</span><span class="n">value_parents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">logp</span> <span class="o">=</span> <span class="o">-</span><span class="n">gaussian_surprise</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">value</span><span class="p">,</span>
        <span class="n">expected_mean</span><span class="o">=</span><span class="n">attributes</span><span class="p">[</span><span class="n">value_parent_idx</span><span class="p">][</span><span class="s2">&quot;mean&quot;</span><span class="p">],</span>
        <span class="n">expected_precision</span><span class="o">=</span><span class="n">attributes</span><span class="p">[</span><span class="n">input_idx</span><span class="p">][</span><span class="s2">&quot;expected_precision&quot;</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">logp</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-branching-function">
<h4>The branching function<a class="headerlink" href="#the-branching-function" title="Link to this heading">#</a></h4>
<p>Finally, the third component of the Dirichlet node is the branching function. This function generates a new branch if no other branch can better explain the new incoming observation. Creating a new branch is a two-step process:</p>
<ol class="arabic simple">
<li><p>Creating the network structure.</p></li>
<li><p>Parametrizing the attribute of the network.
The first step is straightforward and mainly requires merging a new <em>base branch</em> in the network. The second step should decide which priors to use for the new branch, which involves non-trivial arbitrary decisions as - by definition - this new branch has only observed one data point so far.</p></li>
</ol>
</section>
<section id="the-dirichlet-process-node">
<h4>The Dirichlet process node<a class="headerlink" href="#the-dirichlet-process-node" title="Link to this heading">#</a></h4>
<p>Finally, we define the main network with a Dirichlet process as the input node. This input takes the base branch as a template to duplicate later.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create the Dirichlet node structure</span>
<span class="n">dirichlet_hgf</span> <span class="o">=</span> <span class="n">HGF</span><span class="p">(</span><span class="n">model_type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">add_nodes</span><span class="p">(</span>
    <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;dirichlet-input&quot;</span><span class="p">,</span>
    <span class="n">node_parameters</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="s2">&quot;base_network&quot;</span><span class="p">:</span> <span class="n">base_network</span><span class="p">,</span>
        <span class="s2">&quot;log_likelihood_fn&quot;</span><span class="p">:</span> <span class="n">log_likelihood_fn</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initializing a network with custom node structure.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dirichlet_hgf</span><span class="o">.</span><span class="n">plot_network</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d806defb84d267ad13caa9acaa1cd3faa0f607b1e8a361d945e5ee3e67744222.svg" src="../_images/d806defb84d267ad13caa9acaa1cd3faa0f607b1e8a361d945e5ee3e67744222.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dirichlet_hgf</span><span class="o">.</span><span class="n">set_update_sequence</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="add-observations-to-the-network">
<h3>Add observations to the network<a class="headerlink" href="#add-observations-to-the-network" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">input_data</span><span class="p">[:</span><span class="mi">10</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">node_idx</span><span class="p">,</span> <span class="n">update_fn</span> <span class="ow">in</span> <span class="n">dirichlet_hgf</span><span class="o">.</span><span class="n">update_sequence</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;dirichlet&quot;</span> <span class="ow">in</span> <span class="n">update_fn</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span>
            <span class="n">attributes</span> <span class="o">=</span> <span class="n">dirichlet_hgf</span><span class="o">.</span><span class="n">attributes</span>
            <span class="n">edges</span> <span class="o">=</span> <span class="n">dirichlet_hgf</span><span class="o">.</span><span class="n">edges</span>
            <span class="n">dirichlet_node</span> <span class="o">=</span> <span class="n">dirichlet_hgf</span><span class="o">.</span><span class="n">dirichlet_node</span>
            <span class="n">input_nodes_idx</span> <span class="o">=</span> <span class="n">dirichlet_hgf</span><span class="o">.</span><span class="n">input_nodes_idx</span>

            <span class="n">attributes</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="n">input_nodes_idx</span><span class="p">,</span> <span class="n">dirichlet_node</span> <span class="o">=</span> <span class="n">update_fn</span><span class="p">(</span>
                <span class="n">edges</span><span class="o">=</span><span class="n">edges</span><span class="p">,</span>
                <span class="n">attributes</span><span class="o">=</span><span class="n">attributes</span><span class="p">,</span>
                <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span>
                <span class="n">time_step</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">node_idx</span><span class="o">=</span><span class="n">node_idx</span><span class="p">,</span>
                <span class="n">dirichlet_node</span><span class="o">=</span><span class="n">dirichlet_node</span><span class="p">,</span>
                <span class="n">input_nodes_idx</span><span class="o">=</span><span class="n">input_nodes_idx</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">dirichlet_hgf</span><span class="o">.</span><span class="n">attributes</span> <span class="o">=</span> <span class="n">attributes</span>
            <span class="n">dirichlet_hgf</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">edges</span>
            <span class="n">dirichlet_hgf</span><span class="o">.</span><span class="n">input_nodes_idx</span> <span class="o">=</span> <span class="n">input_nodes_idx</span>
            <span class="n">dirichlet_hgf</span><span class="o">.</span><span class="n">dirichlet_node</span> <span class="o">=</span> <span class="n">dirichlet_node</span>

            <span class="n">dirichlet_hgf</span><span class="o">.</span><span class="n">set_update_sequence</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">attributes</span> <span class="o">=</span> <span class="n">dirichlet_hgf</span><span class="o">.</span><span class="n">attributes</span>
            <span class="n">edges</span> <span class="o">=</span> <span class="n">dirichlet_hgf</span><span class="o">.</span><span class="n">edges</span>

            <span class="n">attributes</span> <span class="o">=</span> <span class="n">update_fn</span><span class="p">(</span>
                <span class="n">attributes</span><span class="o">=</span><span class="n">attributes</span><span class="p">,</span>
                <span class="n">time_step</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">node_idx</span><span class="o">=</span><span class="n">node_idx</span><span class="p">,</span>
                <span class="n">edges</span><span class="o">=</span><span class="n">edges</span><span class="p">,</span>
                <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span>
                <span class="n">observed</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">dirichlet_hgf</span><span class="o">.</span><span class="n">attributes</span> <span class="o">=</span> <span class="n">attributes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 1 - 1.0
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 1 - 0.3678794503211975
Step 2 - 0.3678794503211975
Step 3 - 0.3678794503211975
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 1 - 0.42085811495780945
Step 2 - 0.42085811495780945
Step 3 - 0.42085811495780945
Step 1 - 0.0
Step 2 - 0.0
Step 3 - 0.0
Step 1 - 0.0
Step 2 - 0.0
Step 3 - 0.0
Step 1 - 0.0
Step 2 - 0.0
Step 3 - 0.0
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 1 - 0.0
Step 2 - 0.0
Step 3 - 0.0
Step 1 - 0.0
Step 2 - 0.0
Step 3 - 0.0
Step 1 - 0.0
Step 2 - 0.0
Step 3 - 0.0
Step 1 - 0.0
Step 2 - 0.0
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 3 - 0.0
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="plotting-results">
<h2>Plotting results<a class="headerlink" href="#plotting-results" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="k">for</span> <span class="n">input_idx</span> <span class="ow">in</span> <span class="n">dirichlet_hgf</span><span class="o">.</span><span class="n">dirichlet_node</span><span class="o">.</span><span class="n">cluster_input_idxs</span><span class="p">:</span>
    <span class="n">value_parent_idx</span> <span class="o">=</span> <span class="n">dirichlet_hgf</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">input_idx</span><span class="p">]</span><span class="o">.</span><span class="n">value_parents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">volatility_parent_idx</span> <span class="o">=</span> <span class="n">dirichlet_hgf</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">input_idx</span><span class="p">]</span><span class="o">.</span><span class="n">volatility_parents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">mean</span> <span class="o">=</span> <span class="n">dirichlet_hgf</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="n">value_parent_idx</span><span class="p">][</span><span class="s2">&quot;expected_mean&quot;</span><span class="p">]</span>

    <span class="c1"># the precision of the Gaussian is given by:</span>
    <span class="n">precision</span> <span class="o">=</span> <span class="n">attributes</span><span class="p">[</span><span class="n">input_idx</span><span class="p">][</span><span class="s2">&quot;expected_precision&quot;</span><span class="p">]</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span>
        <span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">precision</span><span class="p">))</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)),</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;cluster - </span><span class="si">{</span><span class="n">input_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">input_data</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9e6c5d87e3ea8f375f01d30fa1ade0ba05825964c27a439ca5cdde3d65ca690f.png" src="../_images/9e6c5d87e3ea8f375f01d30fa1ade0ba05825964c27a439ca5cdde3d65ca690f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dirichlet_hgf</span><span class="o">.</span><span class="n">plot_network</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/dd6811a059643f72fdf444330c72a069e3f248daa7fdf67d79566def4899e778.svg" src="../_images/dd6811a059643f72fdf444330c72a069e3f248daa7fdf67d79566def4899e778.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dirichlet_hgf</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;n&#39;: [1, 1, 7, 1, 0],
 &#39;n_total&#39;: 10,
 &#39;n_clusters&#39;: 4,
 &#39;alpha&#39;: 0.5,
 &#39;value_coupling_parents&#39;: (1.0, 1.0, 1.0, 1.0, 1.0)}
</pre></div>
</div>
</div>
</div>
</section>
<section id="using-a-dirichlet-process-node">
<h2>Using a Dirichlet process node<a class="headerlink" href="#using-a-dirichlet-process-node" title="Link to this heading">#</a></h2>
<p>A Dirichlet node has the following parameters:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\sigma_\xi\)</span>, the default cluster precision.</p></li>
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span>, the concentration parameter.</p></li>
<li><p><span class="math notranslate nohighlight">\(\pi_i = \frac{n_i}{\alpha + k - 1}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(k\)</span> the current number of clusters</p></li>
<li><p><span class="math notranslate nohighlight">\(n_i\)</span> the number of observations in cluster <span class="math notranslate nohighlight">\(C_i\)</span></p></li>
</ul>
<p>A Dirichlet process over a measurable set <span class="math notranslate nohighlight">\(S\)</span> is specifided by a base distribution <span class="math notranslate nohighlight">\(H\)</span> and a concentration parameter <span class="math notranslate nohighlight">\(\alpha\)</span>. In pyhgf, the base distribution is a tree probabilistic neural network that can operate over <span class="math notranslate nohighlight">\(S\)</span>. When a new set is observed, the Dirichlet node will chose between the following alternatives:</p>
<ol class="arabic simple">
<li><p>Create a new cluster <span class="math notranslate nohighlight">\(C_n\)</span> with probability:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\frac{\alpha}{\alpha + n - 1}p(x|\mu_n, \sigma_n)\)</span></p></li>
<li><p>with <span class="math notranslate nohighlight">\(\mu_n = x\)</span> and <span class="math notranslate nohighlight">\(\sigma_n = \sigma_\xi\)</span></p></li>
</ul>
</li>
<li><p>Merge two cluster <span class="math notranslate nohighlight">\(j\)</span> and <span class="math notranslate nohighlight">\(k\)</span> into a new cluster <span class="math notranslate nohighlight">\(l\)</span> if:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p(x|\mu_l, \sigma_l)\pi_l &lt; p(x|\mu_k, \sigma_k)\pi_k + p(x|\mu_j, \sigma_j)\pi_j\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mu_l = \frac{\mu_j + \mu_k}{2}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma_l = \frac{\sigma_j + \sigma_k}{2}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\pi_l = \frac{n_j + n_k}{\alpha + k - 1}\)</span></p></li>
</ul>
</li>
<li><p>Otherwise, sample from cluster <span class="math notranslate nohighlight">\(C_i\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p(x|\mu_i, \sigma_i)\pi_i \le p(x|\mu_j, \sigma_j)\pi_j \forall j \in C \)</span>.</p></li>
</ul>
</li>
</ol>
<p>First we start by defining the base distribution <span class="math notranslate nohighlight">\(H\)</span>. This requires use to detail how the node can create a new distribution, and how to update this distribution. Those steps are declared in the function <code class="docutils literal notranslate"><span class="pre">base_distribution</span></code> and the variable <code class="docutils literal notranslate"><span class="pre">cluster_updates</span></code> (respectively).</p>
<p>fig, ax = plt.subplots();
def update(frame):
ax.cla()
sns.histplot(x=input_data[:frame], alpha=.2, bins=40, ax=ax);
ax.scatter(input_data[frame], -.5, alpha=.5)</p>
<p>animation = FuncAnimation(fig, update, frames=range(len(input_data)), interval=100)
display(HTML(animation.to_jshtml()))</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-clustering-observations-from-a-gaussian-mixture">Example 1: Clustering observations from a Gaussian mixture</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-the-dataset">Create the dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-the-dirichlet-process-node">Create the Dirichlet process node</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-base-branch">The base branch</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-likelihood-function">The likelihood function</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-branching-function">The branching function</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-dirichlet-process-node">The Dirichlet process node</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-observations-to-the-network">Add observations to the network</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-results">Plotting results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-a-dirichlet-process-node">Using a Dirichlet process node</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/notebooks/Example_4_Dirichlet_process.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2022-2024, Nicolas Legrand.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.2.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>