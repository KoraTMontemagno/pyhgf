Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/nbclient/client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/nbclient/util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/nbclient/util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/nbclient/client.py", line 663, in async_execute
    await self.async_execute_cell(
  File "/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/nbclient/client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/nbclient/client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
with model:
    idata = pm.sample(chains=4, cores=4, tune=1000)
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mTypeError[0m                                 Traceback (most recent call last)
File [0;32m/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/pytensor/compile/function/types.py:970[0m, in [0;36mFunction.__call__[0;34m(self, *args, **kwargs)[0m
[1;32m    968[0m [38;5;28;01mtry[39;00m:
[1;32m    969[0m     outputs [38;5;241m=[39m (
[0;32m--> 970[0m         [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mvm[49m[43m([49m[43m)[49m
[1;32m    971[0m         [38;5;28;01mif[39;00m output_subset [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m
[1;32m    972[0m         [38;5;28;01melse[39;00m [38;5;28mself[39m[38;5;241m.[39mvm(output_subset[38;5;241m=[39moutput_subset)
[1;32m    973[0m     )
[1;32m    974[0m [38;5;28;01mexcept[39;00m [38;5;167;01mException[39;00m:

File [0;32m/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/pytensor/graph/op.py:543[0m, in [0;36mOp.make_py_thunk.<locals>.rval[0;34m(p, i, o, n, params)[0m
[1;32m    539[0m [38;5;129m@is_thunk_type[39m
[1;32m    540[0m [38;5;28;01mdef[39;00m [38;5;21mrval[39m(
[1;32m    541[0m     p[38;5;241m=[39mp, i[38;5;241m=[39mnode_input_storage, o[38;5;241m=[39mnode_output_storage, n[38;5;241m=[39mnode, params[38;5;241m=[39m[38;5;28;01mNone[39;00m
[1;32m    542[0m ):
[0;32m--> 543[0m     r [38;5;241m=[39m [43mp[49m[43m([49m[43mn[49m[43m,[49m[43m [49m[43m[[49m[43mx[49m[43m[[49m[38;5;241;43m0[39;49m[43m][49m[43m [49m[38;5;28;43;01mfor[39;49;00m[43m [49m[43mx[49m[43m [49m[38;5;129;43;01min[39;49;00m[43m [49m[43mi[49m[43m][49m[43m,[49m[43m [49m[43mo[49m[43m)[49m
[1;32m    544[0m     [38;5;28;01mfor[39;00m o [38;5;129;01min[39;00m node[38;5;241m.[39moutputs:

File [0;32m~/work/pyhgf/pyhgf/pyhgf/distribution.py:525[0m, in [0;36mHGFDistribution.perform[0;34m(self, node, inputs, outputs)[0m
[1;32m    524[0m [38;5;250m[39m[38;5;124;03m"""Run the function forward."""[39;00m
[0;32m--> 525[0m result [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mhgf_logp[49m[43m([49m[38;5;241;43m*[39;49m[43minputs[49m[43m)[49m
[1;32m    526[0m outputs[[38;5;241m0[39m][[38;5;241m0[39m] [38;5;241m=[39m np[38;5;241m.[39masarray(result, dtype[38;5;241m=[39mnode[38;5;241m.[39moutputs[[38;5;241m0[39m][38;5;241m.[39mdtype)

    [0;31m[... skipping hidden 12 frame][0m

File [0;32m~/work/pyhgf/pyhgf/pyhgf/distribution.py:202[0m, in [0;36mhgf_logp[0;34m(omega_1, omega_2, omega_3, omega_input, rho_1, rho_2, rho_3, pi_1, pi_2, pi_3, mu_1, mu_2, mu_3, kappa_1, kappa_2, input_data, response_function, model_type, n_levels, response_function_parameters, time)[0m
[1;32m    199[0m     kappas: Dict[[38;5;28mstr[39m, Optional[[38;5;28mfloat[39m]] [38;5;241m=[39m {[38;5;124m"[39m[38;5;124m1[39m[38;5;124m"[39m: kappa_1[i], [38;5;124m"[39m[38;5;124m2[39m[38;5;124m"[39m: kappa_2[i]}
[1;32m    201[0m     surprise [38;5;241m=[39m surprise [38;5;241m+[39m (
[0;32m--> 202[0m         [43mHGF[49m[43m([49m
[1;32m    203[0m [43m            [49m[43minitial_mu[49m[38;5;241;43m=[39;49m[43minitial_mu[49m[43m,[49m
[1;32m    204[0m [43m            [49m[43minitial_pi[49m[38;5;241;43m=[39;49m[43minitial_pi[49m[43m,[49m
[1;32m    205[0m [43m            [49m[43momega[49m[38;5;241;43m=[39;49m[43momega[49m[43m,[49m
[1;32m    206[0m [43m            [49m[43momega_input[49m[38;5;241;43m=[39;49m[43momega_input[49m[43m[[49m[43mi[49m[43m][49m[43m,[49m
[1;32m    207[0m [43m            [49m[43mrho[49m[38;5;241;43m=[39;49m[43mrho[49m[43m,[49m
[1;32m    208[0m [43m            [49m[43mkappas[49m[38;5;241;43m=[39;49m[43mkappas[49m[43m,[49m
[1;32m    209[0m [43m            [49m[43mmodel_type[49m[38;5;241;43m=[39;49m[43mmodel_type[49m[43m,[49m
[1;32m    210[0m [43m            [49m[43mn_levels[49m[38;5;241;43m=[39;49m[43mn_levels[49m[43m,[49m
[1;32m    211[0m [43m            [49m[43meta0[49m[38;5;241;43m=[39;49m[38;5;241;43m0.0[39;49m[43m,[49m
[1;32m    212[0m [43m            [49m[43meta1[49m[38;5;241;43m=[39;49m[38;5;241;43m1.0[39;49m[43m,[49m
[1;32m    213[0m [43m            [49m[43mpihat[49m[38;5;241;43m=[39;49m[43mjnp[49m[38;5;241;43m.[39;49m[43minf[49m[43m,[49m
[1;32m    214[0m [43m            [49m[43mverbose[49m[38;5;241;43m=[39;49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m
[1;32m    215[0m [43m        [49m[43m)[49m
[1;32m    216[0m [43m        [49m[38;5;241;43m.[39;49m[43minput_data[49m[43m([49m[43minput_data[49m[38;5;241;43m=[39;49m[43minput_data[49m[43m[[49m[43mi[49m[43m][49m[43m,[49m[43m [49m[43mtime[49m[38;5;241;43m=[39;49m[43mtime[49m[43m[[49m[43mi[49m[43m][49m[43m)[49m
[1;32m    217[0m         [38;5;241m.[39msurprise(
[1;32m    218[0m             response_function[38;5;241m=[39mresponse_function,
[1;32m    219[0m             response_function_parameters[38;5;241m=[39mresponse_function_parameters,
[1;32m    220[0m         )
[1;32m    221[0m     )
[1;32m    223[0m [38;5;66;03m# Return the sum of the log probabilities (negative surprise)[39;00m

File [0;32m~/work/pyhgf/pyhgf/pyhgf/model.py:231[0m, in [0;36mHGF.input_data[0;34m(self, input_data, time)[0m
[1;32m    227[0m [38;5;66;03m# Run the entire for loop[39;00m
[1;32m    228[0m [38;5;66;03m# this is where the model loop over the input time series[39;00m
[1;32m    229[0m [38;5;66;03m# at each input the node structure is traversed and beliefs are updated[39;00m
[1;32m    230[0m [38;5;66;03m# using precision-weighted prediction errors[39;00m
[0;32m--> 231[0m _, node_trajectories [38;5;241m=[39m [43mscan[49m[43m([49m[43mscan_fn[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mnode_structure[49m[43m,[49m[43m [49m[43mdata[49m[43m)[49m
[1;32m    233[0m [38;5;66;03m# the node structure at each value update[39;00m

    [0;31m[... skipping hidden 8 frame][0m

File [0;32m/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/jax/linear_util.py:167[0m, in [0;36mWrappedFun.call_wrapped[0;34m(self, *args, **kwargs)[0m
[1;32m    166[0m [38;5;28;01mtry[39;00m:
[0;32m--> 167[0m   ans [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mf[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[38;5;28;43mdict[39;49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mparams[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m[43m)[49m
[1;32m    168[0m [38;5;28;01mexcept[39;00m:
[1;32m    169[0m   [38;5;66;03m# Some transformations yield from inside context managers, so we have to[39;00m
[1;32m    170[0m   [38;5;66;03m# interrupt them before reraising the exception. Otherwise they will only[39;00m
[1;32m    171[0m   [38;5;66;03m# get garbage-collected at some later time, running their cleanup tasks[39;00m
[1;32m    172[0m   [38;5;66;03m# only after this exception is handled, which can corrupt the global[39;00m
[1;32m    173[0m   [38;5;66;03m# state.[39;00m

[0;31mTypeError[0m: loop_inputs() missing 1 required positional argument: 'node_structure'

During handling of the above exception, another exception occurred:

[0;31mTypeError[0m                                 Traceback (most recent call last)
Cell [0;32mIn[8], line 2[0m
[1;32m      1[0m [38;5;28;01mwith[39;00m model:
[0;32m----> 2[0m     idata [38;5;241m=[39m [43mpm[49m[38;5;241;43m.[39;49m[43msample[49m[43m([49m[43mchains[49m[38;5;241;43m=[39;49m[38;5;241;43m4[39;49m[43m,[49m[43m [49m[43mcores[49m[38;5;241;43m=[39;49m[38;5;241;43m4[39;49m[43m,[49m[43m [49m[43mtune[49m[38;5;241;43m=[39;49m[38;5;241;43m1000[39;49m[43m)[49m

File [0;32m/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/pymc/sampling/mcmc.py:582[0m, in [0;36msample[0;34m(draws, tune, chains, cores, random_seed, progressbar, step, nuts_sampler, initvals, init, jitter_max_retries, n_init, trace, discard_tuned_samples, compute_convergence_checks, keep_warning_stat, return_inferencedata, idata_kwargs, callback, mp_ctx, model, **kwargs)[0m
[1;32m    580[0m         [kwargs[38;5;241m.[39msetdefault(k, v) [38;5;28;01mfor[39;00m k, v [38;5;129;01min[39;00m nuts_kwargs[38;5;241m.[39mitems()]
[1;32m    581[0m     _log[38;5;241m.[39minfo([38;5;124m"[39m[38;5;124mAuto-assigning NUTS sampler...[39m[38;5;124m"[39m)
[0;32m--> 582[0m     initial_points, step [38;5;241m=[39m [43minit_nuts[49m[43m([49m
[1;32m    583[0m [43m        [49m[43minit[49m[38;5;241;43m=[39;49m[43minit[49m[43m,[49m
[1;32m    584[0m [43m        [49m[43mchains[49m[38;5;241;43m=[39;49m[43mchains[49m[43m,[49m
[1;32m    585[0m [43m        [49m[43mn_init[49m[38;5;241;43m=[39;49m[43mn_init[49m[43m,[49m
[1;32m    586[0m [43m        [49m[43mmodel[49m[38;5;241;43m=[39;49m[43mmodel[49m[43m,[49m
[1;32m    587[0m [43m        [49m[43mrandom_seed[49m[38;5;241;43m=[39;49m[43mrandom_seed_list[49m[43m,[49m
[1;32m    588[0m [43m        [49m[43mprogressbar[49m[38;5;241;43m=[39;49m[43mprogressbar[49m[43m,[49m
[1;32m    589[0m [43m        [49m[43mjitter_max_retries[49m[38;5;241;43m=[39;49m[43mjitter_max_retries[49m[43m,[49m
[1;32m    590[0m [43m        [49m[43mtune[49m[38;5;241;43m=[39;49m[43mtune[49m[43m,[49m
[1;32m    591[0m [43m        [49m[43minitvals[49m[38;5;241;43m=[39;49m[43minitvals[49m[43m,[49m
[1;32m    592[0m [43m        [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m,[49m
[1;32m    593[0m [43m    [49m[43m)[49m
[1;32m    595[0m [38;5;28;01mif[39;00m initial_points [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[1;32m    596[0m     [38;5;66;03m# Time to draw/evaluate numeric start points for each chain.[39;00m
[1;32m    597[0m     ipfns [38;5;241m=[39m make_initial_point_fns_per_chain(
[1;32m    598[0m         model[38;5;241m=[39mmodel,
[1;32m    599[0m         overrides[38;5;241m=[39minitvals,
[1;32m    600[0m         jitter_rvs[38;5;241m=[39m[38;5;28mset[39m(),
[1;32m    601[0m         chains[38;5;241m=[39mchains,
[1;32m    602[0m     )

File [0;32m/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/pymc/sampling/mcmc.py:1227[0m, in [0;36minit_nuts[0;34m(init, chains, n_init, model, random_seed, progressbar, jitter_max_retries, tune, initvals, **kwargs)[0m
[1;32m   1220[0m _log[38;5;241m.[39minfo([38;5;124mf[39m[38;5;124m"[39m[38;5;124mInitializing NUTS using [39m[38;5;132;01m{[39;00minit[38;5;132;01m}[39;00m[38;5;124m...[39m[38;5;124m"[39m)
[1;32m   1222[0m cb [38;5;241m=[39m [
[1;32m   1223[0m     pm[38;5;241m.[39mcallbacks[38;5;241m.[39mCheckParametersConvergence(tolerance[38;5;241m=[39m[38;5;241m1e-2[39m, diff[38;5;241m=[39m[38;5;124m"[39m[38;5;124mabsolute[39m[38;5;124m"[39m),
[1;32m   1224[0m     pm[38;5;241m.[39mcallbacks[38;5;241m.[39mCheckParametersConvergence(tolerance[38;5;241m=[39m[38;5;241m1e-2[39m, diff[38;5;241m=[39m[38;5;124m"[39m[38;5;124mrelative[39m[38;5;124m"[39m),
[1;32m   1225[0m ]
[0;32m-> 1227[0m initial_points [38;5;241m=[39m [43m_init_jitter[49m[43m([49m
[1;32m   1228[0m [43m    [49m[43mmodel[49m[43m,[49m
[1;32m   1229[0m [43m    [49m[43minitvals[49m[43m,[49m
[1;32m   1230[0m [43m    [49m[43mseeds[49m[38;5;241;43m=[39;49m[43mrandom_seed_list[49m[43m,[49m
[1;32m   1231[0m [43m    [49m[43mjitter[49m[38;5;241;43m=[39;49m[38;5;124;43m"[39;49m[38;5;124;43mjitter[39;49m[38;5;124;43m"[39;49m[43m [49m[38;5;129;43;01min[39;49;00m[43m [49m[43minit[49m[43m,[49m
[1;32m   1232[0m [43m    [49m[43mjitter_max_retries[49m[38;5;241;43m=[39;49m[43mjitter_max_retries[49m[43m,[49m
[1;32m   1233[0m [43m[49m[43m)[49m
[1;32m   1235[0m apoints [38;5;241m=[39m [DictToArrayBijection[38;5;241m.[39mmap(point) [38;5;28;01mfor[39;00m point [38;5;129;01min[39;00m initial_points]
[1;32m   1236[0m apoints_data [38;5;241m=[39m [apoint[38;5;241m.[39mdata [38;5;28;01mfor[39;00m apoint [38;5;129;01min[39;00m apoints]

File [0;32m/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/pymc/sampling/mcmc.py:1121[0m, in [0;36m_init_jitter[0;34m(model, initvals, seeds, jitter, jitter_max_retries)[0m
[1;32m   1119[0m [38;5;28;01mif[39;00m i [38;5;241m<[39m jitter_max_retries:
[1;32m   1120[0m     [38;5;28;01mtry[39;00m:
[0;32m-> 1121[0m         [43mmodel[49m[38;5;241;43m.[39;49m[43mcheck_start_vals[49m[43m([49m[43mpoint[49m[43m)[49m
[1;32m   1122[0m     [38;5;28;01mexcept[39;00m SamplingError:
[1;32m   1123[0m         [38;5;66;03m# Retry with a new seed[39;00m
[1;32m   1124[0m         seed [38;5;241m=[39m rng[38;5;241m.[39mrandint([38;5;241m2[39m[38;5;241m*[39m[38;5;241m*[39m[38;5;241m30[39m, dtype[38;5;241m=[39mnp[38;5;241m.[39mint64)

File [0;32m/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/pymc/model.py:1776[0m, in [0;36mModel.check_start_vals[0;34m(self, start)[0m
[1;32m   1770[0m     valid_keys [38;5;241m=[39m [38;5;124m"[39m[38;5;124m, [39m[38;5;124m"[39m[38;5;241m.[39mjoin(value_names_set)
[1;32m   1771[0m     [38;5;28;01mraise[39;00m [38;5;167;01mKeyError[39;00m(
[1;32m   1772[0m         [38;5;124m"[39m[38;5;124mSome start parameters do not appear in the model![39m[38;5;130;01m\n[39;00m[38;5;124m"[39m
[1;32m   1773[0m         [38;5;124mf[39m[38;5;124m"[39m[38;5;124mValid keys are: [39m[38;5;132;01m{[39;00mvalid_keys[38;5;132;01m}[39;00m[38;5;124m, but [39m[38;5;132;01m{[39;00mextra_keys[38;5;132;01m}[39;00m[38;5;124m was supplied[39m[38;5;124m"[39m
[1;32m   1774[0m     )
[0;32m-> 1776[0m initial_eval [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mpoint_logps[49m[43m([49m[43mpoint[49m[38;5;241;43m=[39;49m[43melem[49m[43m)[49m
[1;32m   1778[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m [38;5;28mall[39m(np[38;5;241m.[39misfinite(v) [38;5;28;01mfor[39;00m v [38;5;129;01min[39;00m initial_eval[38;5;241m.[39mvalues()):
[1;32m   1779[0m     [38;5;28;01mraise[39;00m SamplingError(
[1;32m   1780[0m         [38;5;124m"[39m[38;5;124mInitial evaluation of model at starting point failed![39m[38;5;130;01m\n[39;00m[38;5;124m"[39m
[1;32m   1781[0m         [38;5;124mf[39m[38;5;124m"[39m[38;5;124mStarting values:[39m[38;5;130;01m\n[39;00m[38;5;132;01m{[39;00melem[38;5;132;01m}[39;00m[38;5;130;01m\n[39;00m[38;5;130;01m\n[39;00m[38;5;124m"[39m
[1;32m   1782[0m         [38;5;124mf[39m[38;5;124m"[39m[38;5;124mInitial evaluation results:[39m[38;5;130;01m\n[39;00m[38;5;132;01m{[39;00minitial_eval[38;5;132;01m}[39;00m[38;5;124m"[39m
[1;32m   1783[0m     )

File [0;32m/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/pymc/model.py:1810[0m, in [0;36mModel.point_logps[0;34m(self, point, round_vals)[0m
[1;32m   1804[0m factors [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mbasic_RVs [38;5;241m+[39m [38;5;28mself[39m[38;5;241m.[39mpotentials
[1;32m   1805[0m factor_logps_fn [38;5;241m=[39m [at[38;5;241m.[39msum(factor) [38;5;28;01mfor[39;00m factor [38;5;129;01min[39;00m [38;5;28mself[39m[38;5;241m.[39mlogp(factors, [38;5;28msum[39m[38;5;241m=[39m[38;5;28;01mFalse[39;00m)]
[1;32m   1806[0m [38;5;28;01mreturn[39;00m {
[1;32m   1807[0m     factor[38;5;241m.[39mname: np[38;5;241m.[39mround(np[38;5;241m.[39masarray(factor_logp), round_vals)
[1;32m   1808[0m     [38;5;28;01mfor[39;00m factor, factor_logp [38;5;129;01min[39;00m [38;5;28mzip[39m(
[1;32m   1809[0m         factors,
[0;32m-> 1810[0m         [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mcompile_fn[49m[43m([49m[43mfactor_logps_fn[49m[43m)[49m[43m([49m[43mpoint[49m[43m)[49m,
[1;32m   1811[0m     )
[1;32m   1812[0m }

File [0;32m/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/pymc/pytensorf.py:764[0m, in [0;36mPointFunc.__call__[0;34m(self, state)[0m
[1;32m    763[0m [38;5;28;01mdef[39;00m [38;5;21m__call__[39m([38;5;28mself[39m, state):
[0;32m--> 764[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mf[49m[43m([49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mstate[49m[43m)[49m

File [0;32m/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/pytensor/compile/function/types.py:983[0m, in [0;36mFunction.__call__[0;34m(self, *args, **kwargs)[0m
[1;32m    981[0m     [38;5;28;01mif[39;00m [38;5;28mhasattr[39m([38;5;28mself[39m[38;5;241m.[39mvm, [38;5;124m"[39m[38;5;124mthunks[39m[38;5;124m"[39m):
[1;32m    982[0m         thunk [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mvm[38;5;241m.[39mthunks[[38;5;28mself[39m[38;5;241m.[39mvm[38;5;241m.[39mposition_of_error]
[0;32m--> 983[0m     [43mraise_with_op[49m[43m([49m
[1;32m    984[0m [43m        [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mmaker[49m[38;5;241;43m.[39;49m[43mfgraph[49m[43m,[49m
[1;32m    985[0m [43m        [49m[43mnode[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mvm[49m[38;5;241;43m.[39;49m[43mnodes[49m[43m[[49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mvm[49m[38;5;241;43m.[39;49m[43mposition_of_error[49m[43m][49m[43m,[49m
[1;32m    986[0m [43m        [49m[43mthunk[49m[38;5;241;43m=[39;49m[43mthunk[49m[43m,[49m
[1;32m    987[0m [43m        [49m[43mstorage_map[49m[38;5;241;43m=[39;49m[38;5;28;43mgetattr[39;49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mvm[49m[43m,[49m[43m [49m[38;5;124;43m"[39;49m[38;5;124;43mstorage_map[39;49m[38;5;124;43m"[39;49m[43m,[49m[43m [49m[38;5;28;43;01mNone[39;49;00m[43m)[49m[43m,[49m
[1;32m    988[0m [43m    [49m[43m)[49m
[1;32m    989[0m [38;5;28;01melse[39;00m:
[1;32m    990[0m     [38;5;66;03m# old-style linkers raise their own exceptions[39;00m
[1;32m    991[0m     [38;5;28;01mraise[39;00m

File [0;32m/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/pytensor/link/utils.py:535[0m, in [0;36mraise_with_op[0;34m(fgraph, node, thunk, exc_info, storage_map)[0m
[1;32m    530[0m     warnings[38;5;241m.[39mwarn(
[1;32m    531[0m         [38;5;124mf[39m[38;5;124m"[39m[38;5;132;01m{[39;00mexc_type[38;5;132;01m}[39;00m[38;5;124m error does not allow us to add an extra error message[39m[38;5;124m"[39m
[1;32m    532[0m     )
[1;32m    533[0m     [38;5;66;03m# Some exception need extra parameter in inputs. So forget the[39;00m
[1;32m    534[0m     [38;5;66;03m# extra long error message in that case.[39;00m
[0;32m--> 535[0m [38;5;28;01mraise[39;00m exc_value[38;5;241m.[39mwith_traceback(exc_trace)

File [0;32m/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/pytensor/compile/function/types.py:970[0m, in [0;36mFunction.__call__[0;34m(self, *args, **kwargs)[0m
[1;32m    967[0m t0_fn [38;5;241m=[39m time[38;5;241m.[39mperf_counter()
[1;32m    968[0m [38;5;28;01mtry[39;00m:
[1;32m    969[0m     outputs [38;5;241m=[39m (
[0;32m--> 970[0m         [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mvm[49m[43m([49m[43m)[49m
[1;32m    971[0m         [38;5;28;01mif[39;00m output_subset [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m
[1;32m    972[0m         [38;5;28;01melse[39;00m [38;5;28mself[39m[38;5;241m.[39mvm(output_subset[38;5;241m=[39moutput_subset)
[1;32m    973[0m     )
[1;32m    974[0m [38;5;28;01mexcept[39;00m [38;5;167;01mException[39;00m:
[1;32m    975[0m     restore_defaults()

File [0;32m/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/pytensor/graph/op.py:543[0m, in [0;36mOp.make_py_thunk.<locals>.rval[0;34m(p, i, o, n, params)[0m
[1;32m    539[0m [38;5;129m@is_thunk_type[39m
[1;32m    540[0m [38;5;28;01mdef[39;00m [38;5;21mrval[39m(
[1;32m    541[0m     p[38;5;241m=[39mp, i[38;5;241m=[39mnode_input_storage, o[38;5;241m=[39mnode_output_storage, n[38;5;241m=[39mnode, params[38;5;241m=[39m[38;5;28;01mNone[39;00m
[1;32m    542[0m ):
[0;32m--> 543[0m     r [38;5;241m=[39m [43mp[49m[43m([49m[43mn[49m[43m,[49m[43m [49m[43m[[49m[43mx[49m[43m[[49m[38;5;241;43m0[39;49m[43m][49m[43m [49m[38;5;28;43;01mfor[39;49;00m[43m [49m[43mx[49m[43m [49m[38;5;129;43;01min[39;49;00m[43m [49m[43mi[49m[43m][49m[43m,[49m[43m [49m[43mo[49m[43m)[49m
[1;32m    544[0m     [38;5;28;01mfor[39;00m o [38;5;129;01min[39;00m node[38;5;241m.[39moutputs:
[1;32m    545[0m         compute_map[o][[38;5;241m0[39m] [38;5;241m=[39m [38;5;28;01mTrue[39;00m

File [0;32m~/work/pyhgf/pyhgf/pyhgf/distribution.py:525[0m, in [0;36mHGFDistribution.perform[0;34m(self, node, inputs, outputs)[0m
[1;32m    523[0m [38;5;28;01mdef[39;00m [38;5;21mperform[39m([38;5;28mself[39m, node, inputs, outputs):
[1;32m    524[0m [38;5;250m    [39m[38;5;124;03m"""Run the function forward."""[39;00m
[0;32m--> 525[0m     result [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mhgf_logp[49m[43m([49m[38;5;241;43m*[39;49m[43minputs[49m[43m)[49m
[1;32m    526[0m     outputs[[38;5;241m0[39m][[38;5;241m0[39m] [38;5;241m=[39m np[38;5;241m.[39masarray(result, dtype[38;5;241m=[39mnode[38;5;241m.[39moutputs[[38;5;241m0[39m][38;5;241m.[39mdtype)

    [0;31m[... skipping hidden 12 frame][0m

File [0;32m~/work/pyhgf/pyhgf/pyhgf/distribution.py:202[0m, in [0;36mhgf_logp[0;34m(omega_1, omega_2, omega_3, omega_input, rho_1, rho_2, rho_3, pi_1, pi_2, pi_3, mu_1, mu_2, mu_3, kappa_1, kappa_2, input_data, response_function, model_type, n_levels, response_function_parameters, time)[0m
[1;32m    198[0m     rho: Dict[[38;5;28mstr[39m, Optional[[38;5;28mfloat[39m]] [38;5;241m=[39m {[38;5;124m"[39m[38;5;124m1[39m[38;5;124m"[39m: rho_1[i], [38;5;124m"[39m[38;5;124m2[39m[38;5;124m"[39m: rho_2[i], [38;5;124m"[39m[38;5;124m3[39m[38;5;124m"[39m: rho_3[i]}
[1;32m    199[0m     kappas: Dict[[38;5;28mstr[39m, Optional[[38;5;28mfloat[39m]] [38;5;241m=[39m {[38;5;124m"[39m[38;5;124m1[39m[38;5;124m"[39m: kappa_1[i], [38;5;124m"[39m[38;5;124m2[39m[38;5;124m"[39m: kappa_2[i]}
[1;32m    201[0m     surprise [38;5;241m=[39m surprise [38;5;241m+[39m (
[0;32m--> 202[0m         [43mHGF[49m[43m([49m
[1;32m    203[0m [43m            [49m[43minitial_mu[49m[38;5;241;43m=[39;49m[43minitial_mu[49m[43m,[49m
[1;32m    204[0m [43m            [49m[43minitial_pi[49m[38;5;241;43m=[39;49m[43minitial_pi[49m[43m,[49m
[1;32m    205[0m [43m            [49m[43momega[49m[38;5;241;43m=[39;49m[43momega[49m[43m,[49m
[1;32m    206[0m [43m            [49m[43momega_input[49m[38;5;241;43m=[39;49m[43momega_input[49m[43m[[49m[43mi[49m[43m][49m[43m,[49m
[1;32m    207[0m [43m            [49m[43mrho[49m[38;5;241;43m=[39;49m[43mrho[49m[43m,[49m
[1;32m    208[0m [43m            [49m[43mkappas[49m[38;5;241;43m=[39;49m[43mkappas[49m[43m,[49m
[1;32m    209[0m [43m            [49m[43mmodel_type[49m[38;5;241;43m=[39;49m[43mmodel_type[49m[43m,[49m
[1;32m    210[0m [43m            [49m[43mn_levels[49m[38;5;241;43m=[39;49m[43mn_levels[49m[43m,[49m
[1;32m    211[0m [43m            [49m[43meta0[49m[38;5;241;43m=[39;49m[38;5;241;43m0.0[39;49m[43m,[49m
[1;32m    212[0m [43m            [49m[43meta1[49m[38;5;241;43m=[39;49m[38;5;241;43m1.0[39;49m[43m,[49m
[1;32m    213[0m [43m            [49m[43mpihat[49m[38;5;241;43m=[39;49m[43mjnp[49m[38;5;241;43m.[39;49m[43minf[49m[43m,[49m
[1;32m    214[0m [43m            [49m[43mverbose[49m[38;5;241;43m=[39;49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m
[1;32m    215[0m [43m        [49m[43m)[49m
[1;32m    216[0m [43m        [49m[38;5;241;43m.[39;49m[43minput_data[49m[43m([49m[43minput_data[49m[38;5;241;43m=[39;49m[43minput_data[49m[43m[[49m[43mi[49m[43m][49m[43m,[49m[43m [49m[43mtime[49m[38;5;241;43m=[39;49m[43mtime[49m[43m[[49m[43mi[49m[43m][49m[43m)[49m
[1;32m    217[0m         [38;5;241m.[39msurprise(
[1;32m    218[0m             response_function[38;5;241m=[39mresponse_function,
[1;32m    219[0m             response_function_parameters[38;5;241m=[39mresponse_function_parameters,
[1;32m    220[0m         )
[1;32m    221[0m     )
[1;32m    223[0m [38;5;66;03m# Return the sum of the log probabilities (negative surprise)[39;00m
[1;32m    224[0m [38;5;28;01mreturn[39;00m [38;5;241m-[39msurprise

File [0;32m~/work/pyhgf/pyhgf/pyhgf/model.py:231[0m, in [0;36mHGF.input_data[0;34m(self, input_data, time)[0m
[1;32m    225[0m data [38;5;241m=[39m jnp[38;5;241m.[39marray([input_data, time], dtype[38;5;241m=[39m[38;5;28mfloat[39m)[38;5;241m.[39mT
[1;32m    227[0m [38;5;66;03m# Run the entire for loop[39;00m
[1;32m    228[0m [38;5;66;03m# this is where the model loop over the input time series[39;00m
[1;32m    229[0m [38;5;66;03m# at each input the node structure is traversed and beliefs are updated[39;00m
[1;32m    230[0m [38;5;66;03m# using precision-weighted prediction errors[39;00m
[0;32m--> 231[0m _, node_trajectories [38;5;241m=[39m [43mscan[49m[43m([49m[43mscan_fn[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mnode_structure[49m[43m,[49m[43m [49m[43mdata[49m[43m)[49m
[1;32m    233[0m [38;5;66;03m# the node structure at each value update[39;00m
[1;32m    234[0m [38;5;28mself[39m[38;5;241m.[39mnode_trajectories [38;5;241m=[39m node_trajectories

    [0;31m[... skipping hidden 8 frame][0m

File [0;32m/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/jax/linear_util.py:167[0m, in [0;36mWrappedFun.call_wrapped[0;34m(self, *args, **kwargs)[0m
[1;32m    164[0m gen [38;5;241m=[39m gen_static_args [38;5;241m=[39m out_store [38;5;241m=[39m [38;5;28;01mNone[39;00m
[1;32m    166[0m [38;5;28;01mtry[39;00m:
[0;32m--> 167[0m   ans [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mf[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[38;5;28;43mdict[39;49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mparams[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m[43m)[49m
[1;32m    168[0m [38;5;28;01mexcept[39;00m:
[1;32m    169[0m   [38;5;66;03m# Some transformations yield from inside context managers, so we have to[39;00m
[1;32m    170[0m   [38;5;66;03m# interrupt them before reraising the exception. Otherwise they will only[39;00m
[1;32m    171[0m   [38;5;66;03m# get garbage-collected at some later time, running their cleanup tasks[39;00m
[1;32m    172[0m   [38;5;66;03m# only after this exception is handled, which can corrupt the global[39;00m
[1;32m    173[0m   [38;5;66;03m# state.[39;00m
[1;32m    174[0m   [38;5;28;01mwhile[39;00m stack:

[0;31mTypeError[0m: loop_inputs() missing 1 required positional argument: 'node_structure'
Apply node that caused the error: HGFDistribution(omega_1, TensorConstant{-10.0}, TensorConstant{nan}, TensorConstant{-9.210340371976184}, TensorConstant{0.0}, TensorConstant{0.0}, TensorConstant{nan}, TensorConstant{10000.0}, TensorConstant{10.0}, TensorConstant{nan}, TensorConstant{0.0}, TensorConstant{0.0}, TensorConstant{nan}, TensorConstant{1.0}, TensorConstant{nan})
Toposort index: 2
Inputs types: [TensorType(float64, (6,)), TensorType(float32, ()), TensorType(float64, ()), TensorType(float64, ()), TensorType(float32, ()), TensorType(float32, ()), TensorType(float64, ()), TensorType(float32, ()), TensorType(float32, ()), TensorType(float64, ()), TensorType(float32, ()), TensorType(float32, ()), TensorType(float64, ()), TensorType(float32, ()), TensorType(float64, ())]
Inputs shapes: [(6,), (), (), (), (), (), (), (), (), (), (), (), (), (), ()]
Inputs strides: [(8,), (), (), (), (), (), (), (), (), (), (), (), (), (), ()]
Inputs values: ['not shown', array(-10., dtype=float32), array(nan), array(-9.21034037), array(0., dtype=float32), array(0., dtype=float32), array(nan), array(10000., dtype=float32), array(10., dtype=float32), array(nan), array(0., dtype=float32), array(0., dtype=float32), array(nan), array(1., dtype=float32), array(nan)]
Outputs clients: [['output']]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/IPython/core/interactiveshell.py", line 3016, in _run_cell
    result = runner(coro)
  File "/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/IPython/core/async_helpers.py", line 129, in _pseudo_sync_runner
    coro.send(None)
  File "/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/IPython/core/interactiveshell.py", line 3221, in run_cell_async
    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,
  File "/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/IPython/core/interactiveshell.py", line 3400, in run_ast_nodes
    if await self.run_code(code, result, async_=asy):
  File "/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/IPython/core/interactiveshell.py", line 3460, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "/tmp/ipykernel_2198/928765249.py", line 9, in <module>
    hgf_logp_op(
  File "/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/pytensor/graph/op.py", line 295, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/home/runner/work/pyhgf/pyhgf/pyhgf/distribution.py", line 520, in make_node
    outputs = [pt.dscalar()]

HINT: Use the PyTensor flag `exception_verbosity=high` for a debug print-out and storage map footprint of this Apply node.
TypeError: loop_inputs() missing 1 required positional argument: 'node_structure'
Apply node that caused the error: HGFDistribution(omega_1, TensorConstant{-10.0}, TensorConstant{nan}, TensorConstant{-9.210340371976184}, TensorConstant{0.0}, TensorConstant{0.0}, TensorConstant{nan}, TensorConstant{10000.0}, TensorConstant{10.0}, TensorConstant{nan}, TensorConstant{0.0}, TensorConstant{0.0}, TensorConstant{nan}, TensorConstant{1.0}, TensorConstant{nan})
Toposort index: 2
Inputs types: [TensorType(float64, (6,)), TensorType(float32, ()), TensorType(float64, ()), TensorType(float64, ()), TensorType(float32, ()), TensorType(float32, ()), TensorType(float64, ()), TensorType(float32, ()), TensorType(float32, ()), TensorType(float64, ()), TensorType(float32, ()), TensorType(float32, ()), TensorType(float64, ()), TensorType(float32, ()), TensorType(float64, ())]
Inputs shapes: [(6,), (), (), (), (), (), (), (), (), (), (), (), (), (), ()]
Inputs strides: [(8,), (), (), (), (), (), (), (), (), (), (), (), (), (), ()]
Inputs values: ['not shown', array(-10., dtype=float32), array(nan), array(-9.21034037), array(0., dtype=float32), array(0., dtype=float32), array(nan), array(10000., dtype=float32), array(10., dtype=float32), array(nan), array(0., dtype=float32), array(0., dtype=float32), array(nan), array(1., dtype=float32), array(nan)]
Outputs clients: [['output']]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/IPython/core/interactiveshell.py", line 3016, in _run_cell
    result = runner(coro)
  File "/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/IPython/core/async_helpers.py", line 129, in _pseudo_sync_runner
    coro.send(None)
  File "/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/IPython/core/interactiveshell.py", line 3221, in run_cell_async
    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,
  File "/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/IPython/core/interactiveshell.py", line 3400, in run_ast_nodes
    if await self.run_code(code, result, async_=asy):
  File "/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/IPython/core/interactiveshell.py", line 3460, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "/tmp/ipykernel_2198/928765249.py", line 9, in <module>
    hgf_logp_op(
  File "/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/pytensor/graph/op.py", line 295, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/home/runner/work/pyhgf/pyhgf/pyhgf/distribution.py", line 520, in make_node
    outputs = [pt.dscalar()]

HINT: Use the PyTensor flag `exception_verbosity=high` for a debug print-out and storage map footprint of this Apply node.

